# NAVI Backend 프로젝트

## 🚨 필수 규칙 - 반드시 준수

**이 파일의 규칙을 어기면 안 됩니다.**
**작업 전 반드시 이 파일을 먼저 읽고 규칙을 확인하세요.**

---

## ⚠️ 중요: 커밋 규칙
- **한 모듈씩만** 구현하고 커밋
- 한 커밋에 **1개 기능만** 포함
- 여러 모듈 동시 구현 금지

## 작업 순서 (하나씩 진행)
1. Auth 모듈 → 커밋
2. Users 모듈 → 커밋
3. DailyShares 모듈 → 커밋
4. Emotions 모듈 → 커밋
5. Follows 모듈 → 커밋
6. CancerTypes 모듈 → 커밋
7. Upload 모듈 → 커밋

## 커밋 메시지 형식
- feat(auth): 회원가입/로그인 구현
- feat(users): 사용자 프로필 CRUD
- feat(daily-shares): 하루공유 CRUD

## 금지사항
- ❌ 여러 모듈 한 번에 구현
- ❌ 한 커밋에 여러 기능 포함
- ✅ 하나씩 구현하고 바로 커밋

## 기술 스택
- NestJS + TypeScript
- PostgreSQL (Supabase)
- TypeORM

---

## 일반 규칙
- 변경 전 범위를 사용자에게 확인할 것. CLAUDE.md 수정, 추가 기능, 요청 범위 초과 리팩토링 금지
- "X 고쳐줘" → **X만** 고칠 것. 주변 코드 정리/개선 금지
- `any` 타입 사용 금지. 모든 코드는 강타입으로 작성

## 컴포넌트 사용 규칙
- 프로젝트의 **기존 커스텀 컴포넌트**를 항상 우선 사용 (raw HTML 요소 사용 금지)
- 구현 전 `/components` 디렉토리에서 사용 가능한 컴포넌트를 먼저 확인할 것

---

## Workflow 규칙
- 코드 변경 전 **계획을 먼저 설명**하고 사용자 확인을 받을 것
- 멀티 스텝 변경 시 각 단계를 **완전히 완료한 후** 다음 단계로 이동
- 디자인 목업 이미지가 너무 커서 처리 실패 시, 즉시 **리사이즈를 요청**하거나 **텍스트로 설명**을 요청할 것 (재시도 금지)

## API 연동 규칙
- API 페이로드 값은 **백엔드 enum/type 정의와 정확히 일치**시킬 것 (emotion_types, weather types, UserType 등)
- 프론트엔드 구현 전 반드시 **백엔드 enum, DTO, Swagger 스펙을 먼저 읽고** 정확한 값을 확인할 것
- 스펙에 명시된 필드**만** 전송할 것 — 불필요한 추가 필드 전송 금지
- 날짜 형식은 백엔드와 동일하게 맞출 것 (ISO 8601 등)

## TypeScript 규칙
- `.toFixed()`, `.includes()` 등 호출 전 **타입과 null/undefined 체크** 필수
- 객체 배열 비교 시 `.includes()` 대신 **`.some()` 사용**
- 타입 안전성 항상 확보 — undefined/null 접근 방지

## UI/Layout 규칙
- sticky, overflow, scroll 등 레이아웃 수정 시 **부모 컨테이너 체인 전체의 height 제약 조건** 반드시 확인
- `flex-1`이나 `overflow-y-auto`가 작동하려면 **조상 요소의 height가 설정되어 있어야 함**
- UI 레이아웃 변경은 **한 번에 하나의 속성만** 수정하고 확인 후 다음 단계 진행

## Kakao Maps 규칙
- 초기 좌표 props, 마커 클러스터링, 줌 레벨 변경 항상 처리
- 맵 컨테이너에 **명시적 width/height** 필수
- 맵 연동 후 **런타임 에러 테스트** 필수
- 좌표 값은 반드시 **number 타입**으로 전달 (string 금지)
- 마커 클러스터링은 기본 맵 렌더링과 **분리해서** 처리
- 줌 레벨 변경 시 **리렌더링 루프** 발생하지 않는지 확인